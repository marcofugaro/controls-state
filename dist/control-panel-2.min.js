"use strict";var commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}for(var isImplemented=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")},isImplemented$1=function(){try{return!0}catch(e){return!1}},noop=function(){},_undefined=noop(),isValue=function(e){return e!==_undefined&&null!==e},keys=Object.keys,shim=function(e){return keys(isValue(e)?Object(e):e)},keys$1=isImplemented$1()?Object.keys:shim,validValue=function(e){if(!isValue(e))throw new TypeError("Cannot use null or undefined");return e},max=Math.max,shim$1=function(t,n){var r,e,i,o=max(arguments.length,2);for(t=Object(validValue(t)),i=function(e){try{t[e]=n[e]}catch(e){r||(r=e)}},e=1;e<o;++e)n=arguments[e],keys$1(n).forEach(i);if(void 0!==r)throw r;return t},assign=isImplemented()?Object.assign:shim$1,forEach=Array.prototype.forEach,create=Object.create,process$1=function(e,t){var n;for(n in e)t[n]=e[n]},normalizeOptions=function(e){var t=create(null);return forEach.call(arguments,function(e){isValue(e)&&process$1(Object(e),t)}),t},isCallable=function(e){return"function"==typeof e},str="razdwatrzy",isImplemented$2=function(){return"function"==typeof str.contains&&(!0===str.contains("dwa")&&!1===str.contains("foo"))},indexOf=String.prototype.indexOf,shim$2=function(e){return-1<indexOf.call(this,e,arguments[1])},contains=isImplemented$2()?String.prototype.contains:shim$2,d_1=createCommonjsModule(function(e){(e.exports=function(e,t){var n,r,i,o,a;return arguments.length<2||"string"!=typeof e?(o=t,t=e,e=null):o=arguments[2],null==e?(n=i=!0,r=!1):(n=contains.call(e,"c"),r=contains.call(e,"e"),i=contains.call(e,"w")),a={value:t,configurable:n,enumerable:r,writable:i},o?assign(normalizeOptions(o),a):a}).gs=function(e,t,n){var r,i,o,a;return"string"!=typeof e?(o=n,n=t,t=e,e=null):o=arguments[3],null==t?t=void 0:isCallable(t)?null==n?n=void 0:isCallable(n)||(o=n,n=void 0):(o=t,t=n=void 0),null==e?i=!(r=!0):(r=contains.call(e,"c"),i=contains.call(e,"e")),a={get:t,set:n,configurable:r,enumerable:i},o?assign(normalizeOptions(o),a):a}}),validCallable=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e},eventEmitter=createCommonjsModule(function(e,t){var i,n,o,r,a,l,s,c=Function.prototype.apply,u=Function.prototype.call,f=Object.create,h=Object.defineProperty,d=Object.defineProperties,p=Object.prototype.hasOwnProperty,b={configurable:!0,enumerable:!1,writable:!0};n=function(e,t){var n,r;return validCallable(t),i.call(r=this,e,n=function(){o.call(r,e,n),c.call(t,this,arguments)}),n.__eeOnceListener__=t,this},a={on:i=function(e,t){var n;return validCallable(t),p.call(this,"__ee__")?n=this.__ee__:(n=b.value=f(null),h(this,"__ee__",b),b.value=null),n[e]?"object"==typeof n[e]?n[e].push(t):n[e]=[n[e],t]:n[e]=t,this},once:n,off:o=function(e,t){var n,r,i,o;if(validCallable(t),!p.call(this,"__ee__"))return this;if(!(n=this.__ee__)[e])return this;if("object"==typeof(r=n[e]))for(o=0;i=r[o];++o)i!==t&&i.__eeOnceListener__!==t||(2===r.length?n[e]=r[o?0:1]:r.splice(o,1));else r!==t&&r.__eeOnceListener__!==t||delete n[e];return this},emit:r=function(e){var t,n,r,i,o;if(p.call(this,"__ee__")&&(i=this.__ee__[e]))if("object"==typeof i){for(n=arguments.length,o=new Array(n-1),t=1;t<n;++t)o[t-1]=arguments[t];for(i=i.slice(),t=0;r=i[t];++t)c.call(r,this,o)}else switch(arguments.length){case 1:u.call(i,this);break;case 2:u.call(i,this,arguments[1]);break;case 3:u.call(i,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),t=1;t<n;++t)o[t-1]=arguments[t];c.call(i,this,o)}}},l={on:d_1(i),once:d_1(n),off:d_1(o),emit:d_1(r)},s=d({},l),e.exports=t=function(e){return null==e?f(s):d(Object(e),l)},t.methods=a}),eventEmitter_1=eventEmitter.methods,performanceNow=createCommonjsModule(function(a){(function(){var e,t,n,r,i,o;"undefined"!=typeof performance&&null!==performance&&performance.now?a.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(a.exports=function(){return(e()-i)/1e6},t=process.hrtime,r=(e=function(){var e;return 1e9*(e=t())[0]+e[1]})(),o=1e9*process.uptime(),i=r-o):Date.now?(a.exports=function(){return Date.now()-n},n=Date.now()):(a.exports=function(){return(new Date).getTime()-n},n=(new Date).getTime())}).call(commonjsGlobal)}),root="undefined"==typeof window?commonjsGlobal:window,vendors=["moz","webkit"],suffix="AnimationFrame",raf=root["request"+suffix],caf=root["cancel"+suffix]||root["cancelRequest"+suffix],i=0;!raf&&i<vendors.length;i++)raf=root[vendors[i]+"Request"+suffix],caf=root[vendors[i]+"Cancel"+suffix]||root[vendors[i]+"CancelRequest"+suffix];if(!raf||!caf){var last=0,id=0,queue=[],frameDuration=1e3/60;raf=function(e){if(0===queue.length){var t=performanceNow(),n=Math.max(0,frameDuration-(t-last));last=n+t,setTimeout(function(){for(var e=queue.slice(0),t=queue.length=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(last)}catch(e){setTimeout(function(){throw e},0)}},Math.round(n))}return queue.push({handle:++id,callback:e,cancelled:!1}),id},caf=function(e){for(var t=0;t<queue.length;t++)queue[t].handle===e&&(queue[t].cancelled=!0)}}var raf_1=function(e){return raf.call(root,e)},cancel=function(){caf.apply(root,arguments)},polyfill=function(e){e||(e=root),e.requestAnimationFrame=raf,e.cancelAnimationFrame=caf};raf_1.cancel=cancel,raf_1.polyfill=polyfill;var field=Field;function Field(e,t,n,r){if(/\./.test(e))throw new Error("Field names may not contain a period");r=r||{};var o=t;this.parent=n||null,this.events=new eventEmitter,this.type=null,this.name=e,this.batchedUpdates={},this.batchUpdatePaths=[],this.batchUpdateRaf=null,Object.defineProperties(this,{$field:{enumerable:!1,value:this},$config:{enumerable:!1,value:r},value:{get:function(){return o},set:function(e){var t={field:this,name:this.name,path:this.path,fullpath:this.path,oldValue:o,value:e},n=[],r=this;do{t.path=n.join(".");var i={};i[t.path||this.name]=Object.assign({},t),r.events.emit&&(r.events.emit("beforeChange",Object.assign({},t)),r.events.emit("beforeChanges",i)),r._batchEmit&&r._batchEmit(t.path,Object.assign({},t)),n.unshift(r.name)}while(r=r.parent);o=e}},path:{enumerable:!0,get:function(){var e=(this.parent||{}).path;return this.name?(e?e+".":"")+this.name:null}}})}Field.prototype={onBeforeChange:function(e){return this.events.on("beforeChange",e),this},offBeforeChange:function(e){return this.events.off("beforeChange",e),this},onBeforeChanges:function(e){return this.events.on("beforeChanges",e),this},offBeforeChanges:function(e){return this.events.off("beforeChanges",e),this},onChange:function(e){return this.events.on("change",e),this},offChange:function(e){return this.events.off("change",e),this},onChanges:function(e){return this.events.on("changes",e),this},offChanges:function(e){return this.events.off("changes",e),this},_emitUpdate:function(){for(this.events.emit("changes",Object.assign({},this.batchedUpdates));this.batchUpdatePaths.length;)for(var e=Object.keys(this.batchedUpdates),t=0;t<e.length;t++){var n=this.batchedUpdates[e[t]],r=this.batchUpdatePaths.pop();this.events.emit("change",n),this.events.emit("change:"+r,n)}this.batchedUpdates={},this.batchUpdateRaf=null},_batchEmit:function(e,t){var n=this.batchedUpdates[t.path];n&&(t.oldValue=n.oldValue),this.batchUpdatePaths.push(e),this.batchedUpdates[e]=t,this.batchUpdateRaf||(this.batchUpdateRaf=raf_1(this._emitUpdate.bind(this)))}};var raw=Raw;function Raw(e,t,n,r){if(!(this instanceof Raw))return new Raw(e,t,n,r);field.call(this,e,t,r,n),this.type="raw"}Raw.prototype=Object.create(field.prototype);var slider=Slider;function Slider(e,t,n,r){if(!(this instanceof Slider))return new Slider(e,t,n,r);t=void 0===t?0:t,n=n||{},field.call(this,e,t,r,n);var i=void 0===n.min?Math.min(t,0):n.min,o=void 0===n.max?Math.max(t,1):n.max,a=void 0===n.step?1:n.step;this.type="slider",this.min=i,this.max=o,this.step=a}Slider.prototype=Object.create(field.prototype);var button=Button;function Button(e,t,n,r){if(!(this instanceof Button))return new Button(e,t,n,r);field.call(this,e,t,r,n),this.type="button"}Button.prototype=Object.create(field.prototype);var textinput=TextInput;function TextInput(e,t,n,r){if(!(this instanceof TextInput))return new TextInput(e,t,n,r);t=void 0===t?"":t,field.call(this,e,t,r,n),this.type="textinput"}TextInput.prototype=Object.create(field.prototype);var color=Color;function Color(e,t,n,r){if(!(this instanceof Color))return new Color(e,t,n);t=void 0===t?"#ffffff":t,field.call(this,e,t,r,n),this.type="color"}Color.prototype=Object.create(field.prototype);var checkbox=Checkbox;function Checkbox(e,t,n,r){if(!(this instanceof Checkbox))return new Checkbox(e,t,n,r);t=void 0===t||!!t,field.call(this,e,t,r,n),this.type="checkbox"}Checkbox.prototype=Object.create(field.prototype);var section=Section,COLOR_REGEX=/(#(?:[0-9a-fA-F]{2,4}){2,4}|(#[0-9a-fA-F]{3})|(rgb|hsl)a?((-?\d+%?[,\s]+){2,3}\s*[\d.]+%?))/;function isHTMLElement(e){return e instanceof Element||e instanceof HTMLDocument}function inferType(e){if(e&&e.type)return e.type+"field";if(isHTMLElement(e))return"rawfield";if("function"==typeof e)return"button";switch(typeof e){case"string":return COLOR_REGEX.test(e)?"color":"textinput";case"number":return"number";case"boolean":return"boolean";case"raw":return"raw";case"button":return"button";case"object":return"object"}}function constructField(e,t,n){switch(inferType(t)){case"rawfield":case"buttonfield":case"colorfield":case"textfield":case"sliderfield":case"selectfield":case"rangesliderfield":case"checkboxfield":case"sectionfield":if(t.path)throw new Error("You may only add an field to a set of controls once.");return t.$field.parent=n,t.name=e,t;case"color":return new color(e,t,{},n);case"raw":return new raw(e,t,{},n);case"button":return new button(e,t,{},n);case"textinput":return new textinput(e,t,{},n);case"number":return new slider(e,t,{},n);case"boolean":return new checkbox(e,t,{},n);case"object":return new Section(e,t,{},n);default:return null}}function Section(e,i,t,n){var o=this;t=t||{};var a={},l={},s={};field.call(this,e,s,n,t),this.type="section",Object.defineProperty(l,"$field",{enumerable:!1,value:this}),Object.defineProperties(s,{$field:{enumerable:!1,value:this},$path:{enumerable:!1,value:l},$displayFields:{enumerable:!1,value:a}}),Object.keys(i).forEach(function(e){var t=a[e]=constructField(e,i[e],o),n=t.$config;if("raw"===t.type){var r=void 0!==n.enumerable&&!!n.enumerable;Object.defineProperty(s,e,{enumerable:r,get:function(){return t.value}}),Object.defineProperty(l,e,{enumerable:r,get:function(){return t}})}else if("section"===t.type){r=void 0===n.enumerable||!!n.enumerable;Object.defineProperty(s,e,{enumerable:r,value:t.value}),Object.defineProperty(l,e,{enumerable:r,value:t.value.$path})}else{r=void 0===n.enumerable||!!n.enumerable;Object.defineProperty(s,e,{enumerable:r,get:function(){return t.value},set:function(e){t.value=e}}),Object.defineProperty(l,e,{enumerable:r,get:function(){return t}})}}),Object.defineProperties(s,{$onBeforeChanges:{enumerable:!1,value:this.onBeforeChanges.bind(this)},$onBeforeChange:{enumerable:!1,value:this.onBeforeChange.bind(this)},$offBeforeChanges:{enumerable:!1,value:this.offBeforeChanges.bind(this)},$offBeforeChange:{enumerable:!1,value:this.offBeforeChange.bind(this)},$onChanges:{enumerable:!1,value:this.onChanges.bind(this)},$onChange:{enumerable:!1,value:this.onChange.bind(this)},$offChanges:{enumerable:!1,value:this.offChanges.bind(this)},$offChange:{enumerable:!1,value:this.offChange.bind(this)}})}Section.prototype=Object.create(field.prototype);var rangeslider=Rangeslider;function Rangeslider(e,t,n,r){if(!(this instanceof Rangeslider))return new Rangeslider(e,t,n,r);t=void 0===t?0:t,n=n||{},field.call(this,e,t,r,n);var i=void 0===n.min?Math.min(t,0):n.min,o=void 0===n.max?Math.max(t,1):n.max,a=void 0===n.step?1:n.step;this.type="rangeslider",this.min=i,this.max=o,this.step=a}Rangeslider.prototype=Object.create(field.prototype);var select=Select;function Select(e,t,n,r){if(!(this instanceof Select))return new Select(e,t,n,r);t=void 0===t?null:t,field.call(this,e,t,r,n),this.options=n.options,this.type="select"}function Controls(e,t){return new section("",e,t).value}Select.prototype=Object.create(field.prototype),Controls.Slider=function(e,t){return new slider(null,e,t)},Controls.Rangeslider=function(e,t){return new rangeslider(null,e,t)},Controls.Textinput=function(e,t){return new textinput(null,e,t)},Controls.Select=function(e,t){return new select(null,e,t)},Controls.Checkbox=function(e,t){return new checkbox(null,e,t)},Controls.Color=function(e,t){return new color(null,e,t)},Controls.Section=function(e,t){return new section(null,e,t)},Controls.Raw=function(e,t){return new raw(null,e,t)};var controlPanel2Orig=Controls;module.exports=controlPanel2Orig;